CLIPS_VERSION=63x
CLIPS_SRC=./source/branches/$(CLIPS_VERSION)/core/*.c
EMCC=emcc
EXPORTS="['_CreateEnvironment','_AllocateEnvironmentData','_DestroyEnvironment','_GetEnvironmentData','_EnvAddPeriodicFunction','_EnvAddResetFunction','_EnvBatchStar','_EnvBload','_EnvBsave','_EnvBuild','_EnvClear','_EnvEval','_EnvFunctionCall','_EnvGetAutoFloatDividend','_EnvGetDynamicConstraintChecking','_EnvGetSequenceOperatorRecognition','_EnvGetStaticConstraintChecking','_Environment','_EnvLoad','_EnvRemoveClearFunction','_EnvRemovePeriodicFunction','_EnvRemoveResetFunction','_EnvReset','_EnvSave','_EnvSetAutoFloatDividend','_EnvSetDynamicConstraintChecking','_EnvSetSequenceOperator','_EnvSetStaticConstraintChecking','_EnvDribbleActive','_EnvDribbleOff','_EnvDribbleOn','_EnvGetWatchItem','_EnvUnwatch','_EnvWatch','_EnvDeftemplateModule','_EnvDeftemplateSlotAllowedValues','_EnvDeftemplateSlotCardinality','_EnvDeftemplateSlotDefaultP','_EnvDeftemplateSlotDefaultValue','_EnvDeftemplateSlotExistP','_EnvDeftemplateSlotMultiP','_EnvDeftemplateSlotNames','_EnvDeftemplateSlotRange','_EnvDeftemplateSlotSingleP','_EnvDeftemplateSlotTypes','_EnvFindDeftemplate','_EnvGetDeftemplateList','_EnvGetDeftemplateName','_EnvGetDeftemplatePPForm','_EnvGetDeftemplateWatch','_EnvGetNextDeftemplate','_EnvIsDeftemplateDeletable','_EnvListDeftemplates','_EnvSetDeftemplateWatch','_EnvUndeftemplate','_EnvAssert','_EnvAssertString','_EnvAssignFactSlotDefaults','_EnvCreateFact','_EnvDecrementFactCount','_EnvFactDeftemplate','_EnvFactExistp','_EnvFactIndex','_EnvFacts','_EnvFactSlotNames','_EnvGetFactDuplication','_EnvGetFactList','_EnvGetFactListChanged','_EnvGetFactPPForm','_EnvGetFactSlot','_EnvGetNextFact','_EnvGetNextFactInTemplate','_EnvIncrementFactCount','_EnvLoadFacts','_EnvLoadFactsFromString','_EnvPPFact','_EnvPutFactSlot','_EnvRetract','_EnvSaveFacts','_EnvSetFactDuplication','_EnvSetFactListChanged','_EnvDeffactsModule','_EnvFindDeffacts','_EnvGetDeffactsList','_EnvGetDeffactsName','_EnvGetDeffactsPPForm','_EnvGetNextDeffacts','_EnvIsDeffactsDeletable','_EnvListDeffacts','_EnvUndeffacts','_EnvDefruleHasBreakpoint','_EnvDefruleModule','_EnvFindDefrule','_EnvGetDefruleList','_EnvGetDefruleName','_EnvGetDefrulePPForm','_EnvGetDefruleWatchActivations','_EnvGetDefruleWatchFirings','_EnvGetIncrementalReset','_EnvGetNextDefrule','_EnvIsDefruleDeletable','_EnvListDefrules','_EnvMatches','_EnvRefresh','_EnvRemoveBreak','_EnvSetBreak','_EnvSetDefruleWatchActivations','_EnvSetDefruleWatchFirings','_EnvSetIncrementalReset','_EnvShowBreaks','_EnvUndefrule','_EnvAddRunFunction','_EnvAgenda','_EnvClearFocusStack','_EnvDeleteActivation','_EnvFocus','_EnvGetActivationName','_EnvGetActivationPPForm','_EnvGetActivationSalience','_EnvGetAgendaChanged','_EnvGetFocus','_EnvGetFocusStack','_EnvGetNextActivation','_EnvGetSalienceEvaluation','_EnvGetStrategy','_EnvListFocusStack','_EnvPopFocus','_EnvRefreshAgenda','_EnvRemoveRunFunction','_EnvReorderAgenda','_EnvRun','_EnvSetActivationSalience','_EnvSetAgendaChanged','_EnvSetSalienceEvaluation','_EnvSetStrategy','_EnvDefglobalModule','_EnvFindDefglobal','_EnvGetDefglobalList','_EnvGetDefglobalName','_EnvGetDefglobalPPForm','_EnvGetDefglobalValue','_EnvGetDefglobalValueForm','_EnvGetDefglobalWatch','_EnvGetGlobalsChanged','_EnvGetNextDefglobal','_EnvGetResetGlobals','_EnvIsDefglobalDeletable','_EnvListDefglobals','_EnvSetDefglobalValue','_EnvSetDefglobalWatch','_EnvSetGlobalsChanged','_EnvSetResetGlobals','_EnvShowDefglobals','_EnvUndefglobal','_EnvDeffunctionModule','_EnvFindDeffunction','_EnvGetDeffunctionList','_EnvGetDeffunctionName','_EnvGetDeffunctionPPForm','_EnvGetDeffunctionWatch','_EnvGetNextDeffunction','_EnvIsDeffunctionDeletable','_EnvListDeffunctions','_EnvSetDeffunctionWatch','_EnvUndeffunction','_EnvDefgenericModule','_EnvFindDefgeneric','_EnvGetDefgenericList','_EnvGetDefgenericName','_EnvGetDefgenericPPForm','_EnvGetDefgenericWatch','_EnvGetNextDefgeneric','_EnvIsDefgenericDeletable','_EnvListDefgenerics','_EnvSetDefgenericWatch','_EnvUndefgeneric','_EnvGetDefmethodDescription','_EnvGetDefmethodList','_EnvGetDefmethodPPForm','_EnvGetDefmethodWatch','_EnvGetMethodRestrictions','_EnvGetNextDefmethod','_EnvIsDefmethodDeletable','_EnvListDefmethods','_EnvSetDefmethodWatch','_EnvUndefmethod','_EnvBrowseClasses','_EnvClassAbstractP','_EnvClassReactiveP','_EnvClassSlots','_EnvClassSubclasses','_EnvClassSuperclasses','_EnvDefclassModule','_EnvDescribeClass','_EnvFindDefclass','_EnvGetClassDefaultsMode','_EnvGetDefclassList','_EnvGetDefclassName','_EnvGetDefclassPPForm','_EnvGetDefclassWatchInstances','_EnvGetDefclassWatchSlots','_EnvGetNextDefclass','_EnvIsDefclassDeletable','_EnvListDefclasses','_EnvSetClassDefaultsMode','_EnvSetDefclassWatchInstances','_EnvSetDefclassWatchSlots','_EnvSlotAllowedClasses','_EnvSlotAllowedValues','_EnvSlotCardinality','_EnvSlotDefaultValue','_EnvSlotDirectAccessP','_EnvSlotExistP','_EnvSlotFacets','_EnvSlotInitableP','_EnvSlotPublicP','_EnvSlotRange','_EnvSlotSources','_EnvSlotTypes','_EnvSlotWritableP','_EnvSubclassP','_EnvSuperclassP','_EnvUndefclass','_EnvBinaryLoadInstances','_EnvBinarySaveInstances','_EnvCreateRawInstance','_EnvDecrementInstanceCount','_EnvDeleteInstance','_EnvDirectGetSlot','_EnvDirectPutSlot','_EnvFindInstance','_EnvGetInstanceClass','_EnvGetInstanceName','_EnvGetInstancePPForm','_EnvGetInstancesChanged','_EnvGetNextInstance','_EnvGetNextInstanceInClass','_EnvGetNextInstanceInClassAndSubclasses','_EnvIncrementInstanceCount','_EnvInstances','_EnvLoadInstances','_EnvLoadInstancesFromString','_EnvMakeInstance','_EnvRestoreInstances','_EnvRestoreInstancesFromString','_EnvSaveInstances','_EnvSend','_EnvSetInstancesChanged','_EnvUnmakeInstance','_EnvValidInstanceAddress','_EnvFindDefmessageHandler','_EnvGetDefmessageHandlerList','_EnvGetDefmessageHandlerName','_EnvGetDefmessageHandlerPPForm','_EnvGetDefmessageHandlerType','_EnvGetDefmessageHandlerWatch','_EnvGetNextDefmessageHandler','_EnvIsDefmessageHandlerDeletable','_EnvListDefmessageHandlers','_EnvPreviewSend','_EnvSetDefmessageHandlerWatch','_EnvUndefmessageHandler','_EnvDefinstancesModule','_EnvFindDefinstances','_EnvGetDefinstancesList','_EnvGetDefinstancesName','_EnvGetDefinstancesPPForm','_EnvGetNextDefinstances','_EnvIsDefinstancesDeletable','_EnvListDefinstances','_EnvUndefinstances','_EnvFindDefmodule','_EnvGetCurrentModule','_EnvGetDefmoduleList','_EnvGetDefmoduleName','_EnvGetDefmodulePPForm','_EnvGetNextDefmodule','_EnvListDefmodules','_EnvSetCurrentModule''_InitializeEvaluationData','_EvaluateExpression','_SetEvaluationError','_GetEvaluationError','_SetHaltExecution','_GetHaltExecution','_ReturnValues','_PrintDataObject','_EnvSetMultifieldErrorValue','_ValueInstall','_ValueDeinstall','_EnvFunctionCall','_FunctionCall2','_CopyDataObject','_AtomInstall','_AtomDeinstall','_ConvertValueToExpression','_GetAtomicHashValue','_InstallPrimitive','_InstallExternalAddressType','_TransferDataObjectValues','_FunctionReferenceExpression','_GetFunctionReference','_DOsEqual','_EvaluateAndStoreInDataObject','_SetMultifieldErrorValue','_FunctionCall']"
OPTIMIZE=-Oz

clips.js: $(CLIPS_SRC)
	$(EMCC) -s EXPORTED_FUNCTIONS=$(EXPORTS) $(OPTIMIZE) $(CLIPS_SRC) -o clips.js

clean:
	rm -f clips.js
	rm -f clips.js.map
